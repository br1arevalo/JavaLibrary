CREATE TABLE IF NOT EXISTS zones (
	ID				SERIAL NOT NULL PRIMARY KEY,
	NAME			VARCHAR(255) NOT NULL,
	DESCRIPTION 	TEXT,
	CREATED_AT 		TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP 
);

CREATE TYPE ROLE_ENUM AS ENUM (
	'ROLE_CLIENT',
	'ROLE_SALESMAN'
);

CREATE TABLE IF NOT EXISTS users (
	ID			SERIAL NOT NULL PRIMARY KEY,
	NAME		VARCHAR(255) NOT NULL,
	AGE			INT DEFAULT 0,
	ROLE		ROLE_ENUM DEFAULT 'ROLE_CLIENT',
	CREATED_AT	TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE IF NOT EXISTS books(
	ID				SERIAL NOT NULL PRIMARY KEY,
	NAME			VARCHAR(255) NOT NULL,
	ISBN			VARCHAR(15),
	FK_zone			SERIAL NOT NULL REFERENCES zones(ID) ON DELETE CASCADE,
	STOCK			INT DEFAULT 0,
	PUBLISHED_AT	DATE DEFAULT CURRENT_DATE,
	CREATED_AT		TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE IF NOT EXISTS sales(
	ID				SERIAL NOT NULL PRIMARY KEY,
	FK_salesman		SERIAL REFERENCES users(ID),
	FK_client		SERIAL REFERENCES users(ID),
	TOTAL			INT NOT NULL,
	CREATED_AT 		TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE IF NOT EXISTS sales_books(
	FK_sale		SERIAL REFERENCES sales(ID),
	FK_book		SERIAL REFERENCES books(ID)
);
